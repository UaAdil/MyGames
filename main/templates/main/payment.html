{% extends 'main/base.html' %}
{% block title %}Оплата заказа{% endblock %}

{% block content %}
<div class="container mx-auto max-w-3xl px-4 py-12">
    <div class="bg-white shadow-xl rounded-xl p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Оплата заказа</h1>

        {% if games %}
            <!-- Список товаров -->
            <div class="mb-6">
                <h2 class="text-xl font-semibold text-gray-700 mb-2">Ваш заказ:</h2>
                <ul class="divide-y divide-gray-200">
                    {% for item in games %}
                        <li class="py-3 flex justify-between">
                            <span>{{ item.name }} × {{ item.quantity }}</span>
                            <span class="font-semibold">{{ item.price|floatformat:0 }} ₸</span>
                        </li>
                    {% endfor %}
                </ul>
                <div class="text-right mt-4 text-lg font-bold text-gray-800">
                    Итого: {{ total|floatformat:0 }} ₸
                </div>
            </div>
        {% else %}
            <p class="text-gray-500 mb-6">Ваша корзина пуста.</p>
        {% endif %}

        <!-- Форма оплаты -->
        <form method="post" action="{% url 'process_payment' %}" class="space-y-6">
            {% csrf_token %}
            <div>
                <label class="block mb-1 font-medium text-gray-700">Имя</label>
                <input type="text" name="name" required
                       class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
            </div>

            <div>
                <label class="block mb-1 font-medium text-gray-700">Email</label>
                <input type="email" name="email" required
                       class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
            </div>

            <div>
                <label class="block mb-2 font-medium text-gray-700">Способ оплаты</label>
                <select name="payment_method" required
                        class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500">
                    <option value="card">Банковская карта</option>
                    <option value="kaspi">Kaspi перевод</option>
                    <option value="cash">Наличные</option>
                </select>
            </div>

            <div>
                <label class="block mb-1 font-medium text-gray-700">Комментарий</label>
                <textarea name="comment" rows="3"
                          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500"
                          placeholder="Например: позвонить заранее, оставить у двери и т.п."></textarea>
            </div>

            <button type="submit"
                    class="w-full bg-red-500 hover:bg-yellow-500 text-white font-semibold py-3 px-6 rounded-lg shadow-lg transition">
                Подтвердить заказ
            </button>
        </form>
    </div>
</div>
{% endblock %}
